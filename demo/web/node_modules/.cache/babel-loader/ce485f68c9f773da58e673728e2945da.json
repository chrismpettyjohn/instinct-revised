{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{FormGroup}from'reactstrap';import{Link,useLocation}from'wouter';import React,{useContext,useState}from'react';import{defaultRegisterState}from'./Register.types';import{configContext,Form,Icon,GuestLayout,Input,sessionContext,sessionService,setURL,userService}from'@instinct-prj/frontend';import ReCAPTCHA from'react-google-recaptcha';setURL('register',/*#__PURE__*/React.createElement(Register,null));export function Register(){var _useContext=useContext(configContext),config=_useContext.config;var _useContext2=useContext(sessionContext),setUser=_useContext2.setUser;// eslint-disable-next-line @typescript-eslint/no-unused-vars\nvar _useLocation=useLocation(),_useLocation2=_slicedToArray(_useLocation,2),location=_useLocation2[0],setLocation=_useLocation2[1];var _useState=useState(defaultRegisterState),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var disabled=state.username===''||state.password===''||state.password!==state.passwordAgain||state.captcha===''||config.siteBeta&&state.betaCode===''||state.showSpinner;function _onChange(key,value){setState(function(_){return _objectSpread(_objectSpread({},_),{},_defineProperty({},key,value));});}function onSubmit(){return _onSubmit.apply(this,arguments);}function _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var bearer,user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_onChange('showSpinner',true);_onChange('showError',false);_context.next=5;return userService.create(state.username,state.password,state.email,state.captcha,state.betaCode);case 5:_context.next=7;return sessionService.attemptCredentials(state.username,state.password);case 7:bearer=_context.sent;_context.next=10;return sessionService.attemptBearerToken(bearer);case 10:user=_context.sent;_context.next=13;return setUser(user);case 13:setLocation('/welcome');_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](0);_onChange('showError',true);case 19:_context.prev=19;_onChange('showSpinner',false);return _context.finish(19);case 22:case\"end\":return _context.stop();}}},_callee,null,[[0,16,19,22]]);}));return _onSubmit.apply(this,arguments);}return/*#__PURE__*/React.createElement(GuestLayout,null,/*#__PURE__*/React.createElement(Form,{className:\"\",disabled:disabled,onSubmit:onSubmit},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"h3\",null,\"Username\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"username\",value:state.username,onChange:_onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"h3\",null,\"Email\"),/*#__PURE__*/React.createElement(Input,{type:\"email\",name:\"email\",value:state.email,onChange:_onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"h3\",null,\"Password\"),/*#__PURE__*/React.createElement(Input,{type:\"password\",name:\"password\",value:state.password,onChange:_onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"h3\",null,\"Password Again\"),/*#__PURE__*/React.createElement(Input,{type:\"password\",name:\"passwordAgain\",value:state.passwordAgain,onChange:_onChange})),config.siteBeta&&/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"h3\",null,\"Beta Code\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"betaCode\",value:state.betaCode,onChange:_onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(ReCAPTCHA,{sitekey:config.googleRecaptchaClientKey,onChange:function onChange(x){return _onChange('captcha',x);}})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success btn-block\",disabled:disabled,type:\"submit\"},\"Register\"),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(Link,{to:\"/login\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-dark btn-block\"},state.showSpinner?/*#__PURE__*/React.createElement(Icon,{className:\"fa-spin\",type:\"spinner\"}):/*#__PURE__*/React.createElement(React.Fragment,null,\"Already Have an Account?\"))))));}","map":{"version":3,"sources":["/Users/cpettyjohn/Habbo/instinct-revised/packages/frontend/modern-theme/src/pages/auth/register/Register.tsx"],"names":["FormGroup","Link","useLocation","React","useContext","useState","defaultRegisterState","configContext","Form","Icon","GuestLayout","Input","sessionContext","sessionService","setURL","userService","ReCAPTCHA","Register","config","setUser","location","setLocation","state","setState","disabled","username","password","passwordAgain","captcha","siteBeta","betaCode","showSpinner","onChange","key","value","_","onSubmit","create","email","attemptCredentials","bearer","attemptBearerToken","user","googleRecaptchaClientKey","x"],"mappings":"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","sourcesContent":["import {FormGroup} from 'reactstrap';\nimport {Link, useLocation} from 'wouter';\nimport React, {useContext, useState} from 'react';\nimport {defaultRegisterState, RegisterState} from './Register.types';\nimport {\n  configContext,\n  Form,\n  Icon,\n  GuestLayout,\n  Input,\n  sessionContext,\n  sessionService,\n  setURL,\n  userService,\n} from '@instinct-prj/frontend';\nimport ReCAPTCHA from 'react-google-recaptcha';\n\nsetURL('register', <Register />);\n\nexport function Register() {\n  const {config} = useContext(configContext);\n  const {setUser} = useContext(sessionContext);\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [location, setLocation] = useLocation();\n  const [state, setState] = useState<RegisterState>(defaultRegisterState);\n\n  const disabled =\n    state.username === '' ||\n    state.password === '' ||\n    state.password !== state.passwordAgain ||\n    state.captcha === '' ||\n    (config.siteBeta && state.betaCode === '') ||\n    state.showSpinner;\n\n  function onChange<K extends keyof RegisterState>(\n    key: K,\n    value: RegisterState[K]\n  ) {\n    setState(_ => ({\n      ..._,\n      [key]: value,\n    }));\n  }\n\n  async function onSubmit() {\n    try {\n      onChange('showSpinner', true);\n      onChange('showError', false);\n      await userService.create(\n        state.username,\n        state.password,\n        state.email,\n        state.captcha!,\n        state.betaCode\n      );\n      const bearer = await sessionService.attemptCredentials(\n        state.username,\n        state.password\n      );\n      const user = await sessionService.attemptBearerToken(bearer);\n      await setUser(user);\n      setLocation('/welcome');\n    } catch (e) {\n      onChange('showError', true);\n    } finally {\n      onChange('showSpinner', false);\n    }\n  }\n\n  return (\n    <GuestLayout>\n      <Form className=\"\" disabled={disabled} onSubmit={onSubmit}>\n        <FormGroup>\n          <h3>Username</h3>\n          <Input\n            type=\"text\"\n            name=\"username\"\n            value={state.username}\n            onChange={onChange}\n          />\n        </FormGroup>\n        <FormGroup>\n          <h3>Email</h3>\n          <Input\n            type=\"email\"\n            name=\"email\"\n            value={state.email}\n            onChange={onChange}\n          />\n        </FormGroup>\n        <FormGroup>\n          <h3>Password</h3>\n          <Input\n            type=\"password\"\n            name=\"password\"\n            value={state.password}\n            onChange={onChange}\n          />\n        </FormGroup>\n        <FormGroup>\n          <h3>Password Again</h3>\n          <Input\n            type=\"password\"\n            name=\"passwordAgain\"\n            value={state.passwordAgain}\n            onChange={onChange}\n          />\n        </FormGroup>\n        {config.siteBeta && (\n          <FormGroup>\n            <h3>Beta Code</h3>\n            <Input\n              type=\"text\"\n              name=\"betaCode\"\n              value={state.betaCode}\n              onChange={onChange}\n            />\n          </FormGroup>\n        )}\n        <FormGroup>\n          <ReCAPTCHA\n            sitekey={config.googleRecaptchaClientKey}\n            onChange={x => onChange('captcha', x as string)}\n          />\n        </FormGroup>\n        <FormGroup>\n          <button\n            className=\"btn btn-success btn-block\"\n            disabled={disabled}\n            type=\"submit\"\n          >\n            Register\n          </button>\n          <hr />\n          <Link to=\"/login\">\n            <button className=\"btn btn-dark btn-block\">\n              {state.showSpinner ? (\n                <Icon className=\"fa-spin\" type=\"spinner\" />\n              ) : (\n                <>Already Have an Account?</>\n              )}\n            </button>\n          </Link>\n        </FormGroup>\n      </Form>\n    </GuestLayout>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}