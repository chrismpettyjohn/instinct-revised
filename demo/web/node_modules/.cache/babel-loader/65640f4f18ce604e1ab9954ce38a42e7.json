{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Link}from'wouter';import{parse}from'query-string';import React,{useState}from'react';import{defaultForgotPasswordState}from'./RedeemForgotPassword.types';import{Button,Card,Container,Form,GuestLayout,Icon,Input,Row,sessionService,setURL}from'@instinct-prj/frontend';setURL('forgot-password/redeem',/*#__PURE__*/React.createElement(RedeemForgotPassword,null));export function RedeemForgotPassword(){var _useState=useState(defaultForgotPasswordState),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];// eslint-disable-next-line no-restricted-globals\nvar params=parse(location.search);var isDisabled=!state.password||!state.passwordAgain;function updateField(key,value){setState(_objectSpread(_objectSpread({},state),{},_defineProperty({},key,value)));}function onSubmit(){return _onSubmit.apply(this,arguments);}function _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setState(function(_){return _objectSpread(_objectSpread({},_),{},{showError:false,showSpinner:true});});_context.prev=1;_context.next=4;return sessionService.redeemForgotPasswordToken(params.token,state.password,state.passwordAgain);case 4:updateField('showCompletion',true);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);setState(function(_){return _objectSpread(_objectSpread({},_),{},{showError:true,showSpinner:false});});case 10:case\"end\":return _context.stop();}}},_callee,null,[[1,7]]);}));return _onSubmit.apply(this,arguments);}if(state.showCompletion){return/*#__PURE__*/React.createElement(GuestLayout,null,/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Card,{header:\"Password Reset\"},/*#__PURE__*/React.createElement(\"div\",{className:\"text-center\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-thumbs-up fa-3x\"}),/*#__PURE__*/React.createElement(\"p\",null,\"Your password has been reset\"),/*#__PURE__*/React.createElement(Link,{to:\"/login\"},/*#__PURE__*/React.createElement(Button,null,\"Login\"))))));}return/*#__PURE__*/React.createElement(GuestLayout,null,/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Card,{header:\"Password Reset\"},!params.token&&/*#__PURE__*/React.createElement(\"div\",{className:\"text-center\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-exclamation-circle fa-3x\"}),/*#__PURE__*/React.createElement(\"p\",null,\"Invalid reset link. Please generate a new one.\")),params.token&&/*#__PURE__*/React.createElement(Form,{className:\"\",onSubmit:onSubmit},state.showError&&/*#__PURE__*/React.createElement(\"div\",{className:\"alert alert-danger\"},/*#__PURE__*/React.createElement(\"h4\",null,\"There was a problem changing your password\")),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-5\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"form-subcategory\"},\"New Password\"),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"column-2\"},/*#__PURE__*/React.createElement(Input,{type:\"password\",name:\"password\",placeholder:\"Enter your new password\",value:state.password,onChange:updateField})))),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"form-subcategory\"},\"New Password Again\"),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"column-2\"},/*#__PURE__*/React.createElement(Input,{type:\"password\",name:\"passwordAgain\",placeholder:\"Enter your new password again\",value:state.passwordAgain,onChange:updateField})))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-help\"},/*#__PURE__*/React.createElement(\"p\",null,\"You must use at least 6 characters. We also recommend you to combine numbers and symbols for strong password protection.\")),/*#__PURE__*/React.createElement(\"div\",{className:\"submit-button\"},/*#__PURE__*/React.createElement(\"button\",{className:\"rounded-button grey\",disabled:isDisabled,type:\"submit\"},state.showSpinner?/*#__PURE__*/React.createElement(Icon,{className:\"fa-spin\",type:\"spinner\"}):'Save'))))));}","map":{"version":3,"sources":["/Users/cpettyjohn/Habbo/instinct-revised/packages/frontend/modern-theme/src/pages/auth/forgot-password/RedeemForgotPassword.tsx"],"names":["Link","parse","React","useState","defaultForgotPasswordState","Button","Card","Container","Form","GuestLayout","Icon","Input","Row","sessionService","setURL","RedeemForgotPassword","state","setState","params","location","search","isDisabled","password","passwordAgain","updateField","key","value","onSubmit","_","showError","showSpinner","redeemForgotPasswordToken","token","showCompletion"],"mappings":"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","sourcesContent":["import {Link} from 'wouter';\nimport {parse} from 'query-string';\nimport React, {useState} from 'react';\nimport {\n  RedeemForgotPasswordState,\n  defaultForgotPasswordState,\n} from './RedeemForgotPassword.types';\nimport {\n  Button,\n  Card,\n  Container,\n  Form,\n  GuestLayout,\n  Icon,\n  Input,\n  Row,\n  sessionService,\n  setURL,\n} from '@instinct-prj/frontend';\n\nsetURL('forgot-password/redeem', <RedeemForgotPassword />);\n\nexport function RedeemForgotPassword() {\n  const [state, setState] = useState<RedeemForgotPasswordState>(\n    defaultForgotPasswordState\n  );\n\n  // eslint-disable-next-line no-restricted-globals\n  const params: {token?: string} = parse(location.search);\n  const isDisabled = !state.password || !state.passwordAgain;\n\n  function updateField<K extends keyof RedeemForgotPasswordState>(\n    key: K,\n    value: RedeemForgotPasswordState[K]\n  ): void {\n    setState({\n      ...state,\n      [key]: value,\n    });\n  }\n\n  async function onSubmit(): Promise<void> {\n    setState(_ => ({\n      ..._,\n      showError: false,\n      showSpinner: true,\n    }));\n\n    try {\n      await sessionService.redeemForgotPasswordToken(\n        params.token!,\n        state.password,\n        state.passwordAgain\n      );\n      updateField('showCompletion', true);\n    } catch {\n      setState(_ => ({\n        ..._,\n        showError: true,\n        showSpinner: false,\n      }));\n    }\n  }\n\n  if (state.showCompletion) {\n    return (\n      <GuestLayout>\n        <Container>\n          <Card header=\"Password Reset\">\n            <div className=\"text-center\">\n              <i className=\"fa fa-thumbs-up fa-3x\" />\n              <p>Your password has been reset</p>\n              <Link to=\"/login\">\n                <Button>Login</Button>\n              </Link>\n            </div>\n          </Card>\n        </Container>\n      </GuestLayout>\n    );\n  }\n\n  return (\n    <GuestLayout>\n      <Container>\n        <Card header=\"Password Reset\">\n          {!params.token && (\n            <div className=\"text-center\">\n              <i className=\"fa fa-exclamation-circle fa-3x\" />\n              <p>Invalid reset link. Please generate a new one.</p>\n            </div>\n          )}\n          {params.token && (\n            <Form className=\"\" onSubmit={onSubmit}>\n              {state.showError && (\n                <div className=\"alert alert-danger\">\n                  <h4>There was a problem changing your password</h4>\n                </div>\n              )}\n              <div className=\"mt-5\">\n                <h4 className=\"form-subcategory\">New Password</h4>\n                <Row>\n                  <div className=\"column-2\">\n                    <Input\n                      type=\"password\"\n                      name=\"password\"\n                      placeholder=\"Enter your new password\"\n                      value={state.password}\n                      onChange={updateField}\n                    />\n                  </div>\n                </Row>\n              </div>\n\n              <div className=\"mt-3\">\n                <h4 className=\"form-subcategory\">New Password Again</h4>\n                <Row>\n                  <div className=\"column-2\">\n                    <Input\n                      type=\"password\"\n                      name=\"passwordAgain\"\n                      placeholder=\"Enter your new password again\"\n                      value={state.passwordAgain}\n                      onChange={updateField}\n                    />\n                  </div>\n                </Row>\n              </div>\n\n              <div className=\"form-help\">\n                <p>\n                  You must use at least 6 characters. We also recommend you to\n                  combine numbers and symbols for strong password protection.\n                </p>\n              </div>\n              <div className=\"submit-button\">\n                <button\n                  className=\"rounded-button grey\"\n                  disabled={isDisabled}\n                  type=\"submit\"\n                >\n                  {state.showSpinner ? (\n                    <Icon className=\"fa-spin\" type=\"spinner\" />\n                  ) : (\n                    'Save'\n                  )}\n                </button>\n              </div>\n            </Form>\n          )}\n        </Card>\n      </Container>\n    </GuestLayout>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}