{"ast":null,"code":"var _jsxFileName = \"/Users/cpettyjohn/Habbo/instinct-revised/packages/frontend/frontend/src/components/template/register-modal/RegisterModal.tsx\";\nimport { useLocation } from 'wouter';\nimport { toast } from 'react-toastify';\nimport { Icon } from '../../generic/icon';\nimport { Loading } from '../../generic/loading';\nimport ReCAPTCHA from 'react-google-recaptcha';\nimport { Form, Input } from '../../generic/form';\nimport React, { useContext, useState } from 'react';\nimport { userService } from '../../../services/user';\nimport { configContext } from '../../../context/config';\nimport { sessionContext } from '../../../context/session';\nimport { sessionService } from '../../../services/session';\nimport { ModalButton } from '../../generic/modal/modal-button';\nimport { defaultRegisterModalState } from './';\nexport function RegisterModal() {\n  const {\n    config\n  } = useContext(configContext); // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n  const [location, setLocation] = useLocation();\n  const [state, setState] = useState(defaultRegisterModalState);\n  const {\n    setUser\n  } = useContext(sessionContext);\n  const disabled = state.username === '' || state.password === '' || state.email === '' || state.password !== state.passwordAgain;\n\n  function setValue(key, value) {\n    setState({ ...state,\n      [key]: value\n    });\n  }\n\n  async function tryRegister() {\n    try {\n      setValue('showSpinner', true);\n      await userService.create(state.username, state.password, state.email, state.captcha);\n      const bearer = await sessionService.attemptCredentials(state.username, state.password);\n      const user = await sessionService.attemptBearerToken(bearer);\n      await setUser(user);\n      setLocation('/me');\n    } catch {\n      toast.error('There was a problem creating your account.');\n      setValue('showSpinner', false);\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(ModalButton, {\n    button: \"Register\",\n    className: \"mr-2\",\n    header: \"Create an Account\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Loading, {\n    isLoading: state.showSpinner,\n    text: \"Creating your account...\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    className: \"login-form\",\n    onSubmit: tryRegister,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"username-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    name: \"username\",\n    placeholder: \"Username\",\n    value: state.username,\n    onChange: setValue,\n    type: \"text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Icon, {\n    type: \"user\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"username-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    name: \"email\",\n    placeholder: \"Email\",\n    value: state.email,\n    onChange: setValue,\n    type: \"email\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Icon, {\n    type: \"envelope\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"password-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    name: \"password\",\n    placeholder: \"Password\",\n    value: state.password,\n    onChange: setValue,\n    type: \"password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Icon, {\n    type: \"lock\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"password-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    name: \"passwordAgain\",\n    placeholder: \"Password Again\",\n    value: state.passwordAgain,\n    onChange: setValue,\n    type: \"password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Icon, {\n    type: \"lock\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mt-2 mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ReCAPTCHA, {\n    sitekey: config.googleRecaptchaClientKey,\n    onChange: x => setValue('captcha', x),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"rounded-button blue plain\",\n    disabled: disabled,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 11\n    }\n  }, \"Create Account\"))));\n}","map":null,"metadata":{},"sourceType":"module"}