{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./Login.scss';import{FormGroup}from'reactstrap';import{Link,useLocation}from'wouter';import React,{useContext,useState}from'react';import{defaultLoginState}from'./Login.types';import{configContext,Form,Icon,Input,GuestLayout,sessionContext,sessionService,setURL}from'@instinct-prj/frontend';setURL('login',/*#__PURE__*/React.createElement(Login,null));export function Login(){var _useContext=useContext(configContext),config=_useContext.config;var _useContext2=useContext(sessionContext),setUser=_useContext2.setUser;// eslint-disable-next-line @typescript-eslint/no-unused-vars\nvar _useLocation=useLocation(),_useLocation2=_slicedToArray(_useLocation,2),location=_useLocation2[0],setLocation=_useLocation2[1];var _useState=useState(defaultLoginState),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var disabled=state.username===''||state.password===''||state.showSpinner;function onChange(key,value){setState(function(_){return _objectSpread(_objectSpread({},_),{},_defineProperty({},key,value));});}function onSubmit(){return _onSubmit.apply(this,arguments);}function _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var bearer,user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;onChange('showSpinner',true);onChange('showError',false);_context.next=5;return sessionService.attemptCredentials(state.username,state.password);case 5:bearer=_context.sent;_context.next=8;return sessionService.attemptBearerToken(bearer);case 8:user=_context.sent;setUser(user);setLocation('/me');_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);onChange('showError',true);case 16:_context.prev=16;onChange('showSpinner',false);return _context.finish(16);case 19:case\"end\":return _context.stop();}}},_callee,null,[[0,13,16,19]]);}));return _onSubmit.apply(this,arguments);}return/*#__PURE__*/React.createElement(GuestLayout,null,/*#__PURE__*/React.createElement(Form,{className:\"\",disabled:disabled,onSubmit:onSubmit},state.showError&&/*#__PURE__*/React.createElement(\"div\",{className:\"alert-danger p-2 mb-3\"},/*#__PURE__*/React.createElement(\"b\",null,\"That is not the right username or password.\")),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"h3\",null,\"Username\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"username\",value:state.username,onChange:onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"h3\",null,\"Password\"),/*#__PURE__*/React.createElement(\"div\",{style:{marginTop:-10}},/*#__PURE__*/React.createElement(Link,{className:\"forgot-password\",to:\"/forgot-password\"},\"Forgot password?\")),/*#__PURE__*/React.createElement(Input,{type:\"password\",name:\"password\",value:state.password,onChange:onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success btn-block\",disabled:disabled,type:\"submit\"},\"Login\"),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(Link,{to:\"/register\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-dark btn-block\"},state.showSpinner?/*#__PURE__*/React.createElement(Icon,{className:\"fa-spin\",type:\"spinner\"}):/*#__PURE__*/React.createElement(React.Fragment,null,\"Join \",config.siteName,\" for Free!\"))))));}","map":{"version":3,"sources":["/Users/cpettyjohn/Habbo/instinct/packages/frontend/modern-theme/src/pages/auth/login/Login.tsx"],"names":["FormGroup","Link","useLocation","React","useContext","useState","defaultLoginState","configContext","Form","Icon","Input","GuestLayout","sessionContext","sessionService","setURL","Login","config","setUser","location","setLocation","state","setState","disabled","username","password","showSpinner","onChange","key","value","_","onSubmit","attemptCredentials","bearer","attemptBearerToken","user","showError","marginTop","siteName"],"mappings":"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","sourcesContent":["import './Login.scss';\nimport {FormGroup} from 'reactstrap';\nimport {Link, useLocation} from 'wouter';\nimport React, {useContext, useState} from 'react';\nimport {defaultLoginState, LoginState} from './Login.types';\nimport {\n  configContext,\n  Form,\n  Icon,\n  Input,\n  GuestLayout,\n  sessionContext,\n  sessionService,\n  setURL,\n} from '@instinct-prj/frontend';\n\nsetURL('login', <Login />);\n\nexport function Login() {\n  const {config} = useContext(configContext);\n  const {setUser} = useContext(sessionContext);\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [location, setLocation] = useLocation();\n  const [state, setState] = useState<LoginState>(defaultLoginState);\n\n  const disabled =\n    state.username === '' || state.password === '' || state.showSpinner;\n\n  function onChange<K extends keyof LoginState>(key: K, value: LoginState[K]) {\n    setState(_ => ({\n      ..._,\n      [key]: value,\n    }));\n  }\n\n  async function onSubmit() {\n    try {\n      onChange('showSpinner', true);\n      onChange('showError', false);\n      const bearer = await sessionService.attemptCredentials(\n        state.username!,\n        state.password!\n      );\n      const user = await sessionService.attemptBearerToken(bearer);\n      setUser(user);\n      setLocation('/me');\n    } catch (e) {\n      onChange('showError', true);\n    } finally {\n      onChange('showSpinner', false);\n    }\n  }\n\n  return (\n    <GuestLayout>\n      <Form className=\"\" disabled={disabled} onSubmit={onSubmit}>\n        {state.showError && (\n          <div className=\"alert-danger p-2 mb-3\">\n            <b>That is not the right username or password.</b>\n          </div>\n        )}\n        <FormGroup>\n          <h3>Username</h3>\n          <Input\n            type=\"text\"\n            name=\"username\"\n            value={state.username}\n            onChange={onChange}\n          />\n        </FormGroup>\n        <FormGroup>\n          <h3>Password</h3>\n          <div style={{marginTop: -10}}>\n            <Link className=\"forgot-password\" to=\"/forgot-password\">\n              Forgot password?\n            </Link>\n          </div>\n          <Input\n            type=\"password\"\n            name=\"password\"\n            value={state.password}\n            onChange={onChange}\n          />\n        </FormGroup>\n        <FormGroup>\n          <button\n            className=\"btn btn-success btn-block\"\n            disabled={disabled}\n            type=\"submit\"\n          >\n            Login\n          </button>\n          <hr />\n          <Link to=\"/register\">\n            <button className=\"btn btn-dark btn-block\">\n              {state.showSpinner ? (\n                <Icon className=\"fa-spin\" type=\"spinner\" />\n              ) : (\n                <>Join {config.siteName} for Free!</>\n              )}\n            </button>\n          </Link>\n        </FormGroup>\n      </Form>\n    </GuestLayout>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}