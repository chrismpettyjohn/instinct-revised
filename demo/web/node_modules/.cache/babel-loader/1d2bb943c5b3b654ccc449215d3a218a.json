{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Form}from'../../generic/form';import{useLocation,Link}from'wouter';import{Input}from'../../generic/form';import{Icon}from'../../generic/icon';import{Loading}from'../../generic/loading';import React,{useContext,useState}from'react';import{sessionContext}from'../../../context/session';import{sessionService}from'../../../services/session';import{defaultLoginModalState}from'./';import{ModalButton}from'../../generic/modal/modal-button';export function LoginModal(){var _useLocation=useLocation(),_useLocation2=_slicedToArray(_useLocation,2),location=_useLocation2[0],setLocation=_useLocation2[1];var _useContext=useContext(sessionContext),setUser=_useContext.setUser;var _useState=useState(defaultLoginModalState),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];function setValue(key,value){setState(function(_){return _objectSpread(_objectSpread({},_),{},_defineProperty({error:key==='showSpinner'?_.error:undefined},key,value));});}function tryLogin(){return _tryLogin.apply(this,arguments);}function _tryLogin(){_tryLogin=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var bearer,user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setValue('showSpinner',true);_context.next=4;return sessionService.attemptCredentials(state.username,state.password);case 4:bearer=_context.sent;_context.next=7;return sessionService.attemptBearerToken(bearer);case 7:user=_context.sent;setUser(user);setLocation('/me');_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);setValue('error',_context.t0.response.data.message[0]);setValue('showSpinner',false);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return _tryLogin.apply(this,arguments);}return/*#__PURE__*/React.createElement(ModalButton,{button:\"Login\",className:\"text-white\",header:\"Login to your account\",style:{background:'transparent'}},/*#__PURE__*/React.createElement(Loading,{isLoading:state.showSpinner,text:\"Attempting to login...\"},/*#__PURE__*/React.createElement(Form,{className:\"login-form\",onSubmit:tryLogin},/*#__PURE__*/React.createElement(\"label\",{className:\"username-input\"},/*#__PURE__*/React.createElement(Input,{name:\"username\",className:state.error==='invalid_username'?'invalid-input':'',placeholder:\"Username\",value:state.username,onChange:setValue,type:\"text\"}),/*#__PURE__*/React.createElement(Icon,{type:\"user\"})),/*#__PURE__*/React.createElement(\"label\",{className:\"password-input\"},/*#__PURE__*/React.createElement(Input,{name:\"password\",className:state.error==='invalid_password'?'invalid-input':'',placeholder:\"Password\",value:state.password,onChange:setValue,type:\"password\"}),/*#__PURE__*/React.createElement(Icon,{type:\"lock\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-2 mb-3\"},/*#__PURE__*/React.createElement(Link,{className:\"text-warning\",to:\"/forgot-password\"},\"Forgot your password?\")),/*#__PURE__*/React.createElement(\"button\",{className:\"rounded-button blue plain\",type:\"submit\"},\"Log In\"))));}","map":{"version":3,"sources":["/Users/cpettyjohn/Habbo/instinct/packages/frontend/frontend/src/components/template/login-modal/LoginModal.tsx"],"names":["Form","useLocation","Link","Input","Icon","Loading","React","useContext","useState","sessionContext","sessionService","defaultLoginModalState","ModalButton","LoginModal","location","setLocation","setUser","state","setState","setValue","key","value","_","error","undefined","tryLogin","attemptCredentials","username","password","bearer","attemptBearerToken","user","response","data","message","background","showSpinner"],"mappings":"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","sourcesContent":["import {Form} from '../../generic/form';\nimport {useLocation, Link} from 'wouter';\nimport {Input} from '../../generic/form';\nimport {Icon} from '../../generic/icon';\nimport {Loading} from '../../generic/loading';\nimport React, {useContext, useState} from 'react';\nimport {sessionContext} from '../../../context/session';\nimport {sessionService} from '../../../services/session';\nimport {LoginModalState, defaultLoginModalState} from './';\nimport {ModalButton} from '../../generic/modal/modal-button';\n\nexport function LoginModal() {\n  const [location, setLocation] = useLocation();\n  const {setUser} = useContext(sessionContext);\n  const [state, setState] = useState<LoginModalState>(defaultLoginModalState);\n\n  function setValue<T extends keyof LoginModalState>(\n    key: T,\n    value: LoginModalState[T]\n  ): void {\n    setState(_ => ({\n      ..._,\n      error: key === 'showSpinner' ? _.error : undefined,\n      [key]: value,\n    }));\n  }\n\n  async function tryLogin(): Promise<void> {\n    try {\n      setValue('showSpinner', true);\n      const bearer = await sessionService.attemptCredentials(\n        state.username!,\n        state.password!\n      );\n      const user = await sessionService.attemptBearerToken(bearer);\n      setUser(user);\n      setLocation('/me');\n    } catch (e) {\n      setValue('error', e.response.data.message[0]);\n      setValue('showSpinner', false);\n    }\n  }\n\n  return (\n    <ModalButton\n      button=\"Login\"\n      className=\"text-white\"\n      header=\"Login to your account\"\n      style={{background: 'transparent'}}\n    >\n      <Loading isLoading={state.showSpinner} text=\"Attempting to login...\">\n        <Form className=\"login-form\" onSubmit={tryLogin}>\n          <label className=\"username-input\">\n            <Input\n              name=\"username\"\n              className={\n                state.error === 'invalid_username' ? 'invalid-input' : ''\n              }\n              placeholder=\"Username\"\n              value={state.username}\n              onChange={setValue}\n              type=\"text\"\n            />\n            <Icon type=\"user\" />\n          </label>\n          <label className=\"password-input\">\n            <Input\n              name=\"password\"\n              className={\n                state.error === 'invalid_password' ? 'invalid-input' : ''\n              }\n              placeholder=\"Password\"\n              value={state.password}\n              onChange={setValue}\n              type=\"password\"\n            />\n            <Icon type=\"lock\" />\n          </label>\n          <div className=\"mt-2 mb-3\">\n            <Link className=\"text-warning\" to=\"/forgot-password\">\n              Forgot your password?\n            </Link>\n          </div>\n          <button className=\"rounded-button blue plain\" type=\"submit\">\n            Log In\n          </button>\n        </Form>\n      </Loading>\n    </ModalButton>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}