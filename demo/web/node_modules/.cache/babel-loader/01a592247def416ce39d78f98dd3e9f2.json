{"ast":null,"code":"import _defineProperty from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Modal,ModalBody,ModalHeader}from'reactstrap';import React,{useContext,useEffect,useState}from'react';import{Avatar,Form,Row,sessionContext,userService,DatePicker}from'@instinct-prj/frontend';import{defaultBanDTO,defaultBanEditorState}from'./BanEditor.types';export function BanEditor(_ref){var _state$user;var children=_ref.children,_ref$defaultBan=_ref.defaultBan,defaultBan=_ref$defaultBan===void 0?defaultBanDTO:_ref$defaultBan,onSave=_ref.onSave;var session=useContext(sessionContext);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(_objectSpread(_objectSpread({},defaultBanEditorState),{},{ban:_objectSpread(_objectSpread({},defaultBan),{},{userID:session.user.id})})),_useState4=_slicedToArray(_useState3,2),state=_useState4[0],setState=_useState4[1];useEffect(function(){function mergeUser(_x){return _mergeUser.apply(this,arguments);}function _mergeUser(){_mergeUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(userID){var user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return userService.getByID(userID);case 2:user=_context.sent;setUsername(user.username);case 4:case\"end\":return _context.stop();}}},_callee);}));return _mergeUser.apply(this,arguments);}mergeUser(state.ban.userID);},[state.ban.userID]);useEffect(function(){function fetchUser(_x2){return _fetchUser.apply(this,arguments);}function _fetchUser(){_fetchUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(userID){var user;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return userService.getByID(userID);case 2:user=_context2.sent;setValue('user',user);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return _fetchUser.apply(this,arguments);}fetchUser(state.ban.userID);},[state.ban.userID]);useEffect(function(){function fetchUser(_x3){return _fetchUser2.apply(this,arguments);}function _fetchUser2(){_fetchUser2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(username){var user;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return userService.getByUsername(username);case 2:user=_context3.sent;setBan('userID',user.user.id);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return _fetchUser2.apply(this,arguments);}fetchUser(username);},[username]);function setValue(key,value){setState(function(_){return _objectSpread(_objectSpread({},_),{},_defineProperty({},key,value));});}function setBan(key,value){setState(function(_){return _objectSpread(_objectSpread({},_),{},{ban:_objectSpread(_objectSpread({},_.ban),{},_defineProperty({},key,value))});});}function toggleModal(){setState(function(_){return _objectSpread(_objectSpread({},_),{},{showModal:!_.showModal});});}function onSubmit(){return _onSubmit.apply(this,arguments);}function _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setValue('showSpinner',true);_context4.prev=1;_context4.next=4;return onSave(state.ban);case 4:setValue('showSpinner',false);_context4.next=10;break;case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](1);setState(function(_){return _objectSpread(_objectSpread({},_),{},{showError:true,showSpinner:false});});case 10:case\"end\":return _context4.stop();}}},_callee4,null,[[1,7]]);}));return _onSubmit.apply(this,arguments);}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{onClick:toggleModal},children),/*#__PURE__*/React.createElement(Modal,{isOpen:state.showModal,toggle:toggleModal},/*#__PURE__*/React.createElement(ModalHeader,{toggle:toggleModal},\"Ban Editor\"),/*#__PURE__*/React.createElement(ModalBody,null,/*#__PURE__*/React.createElement(Form,{className:\"\",onSubmit:onSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-3\",style:{padding:2}},/*#__PURE__*/React.createElement(\"div\",{className:\"col-8\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Username\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",type:\"text\",value:username,onChange:function onChange(e){return setUsername(e.target.value);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(Avatar,{className:\"mt-2\",look:(_state$user=state.user)===null||_state$user===void 0?void 0:_state$user.figure,headOnly:true}))),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\",style:{padding:2}},/*#__PURE__*/React.createElement(\"h4\",null,\"Reason\"),/*#__PURE__*/React.createElement(\"textarea\",{className:\"form-control\",rows:3,value:state.ban.reason,onChange:function onChange(e){return setBan('reason',e.target.value);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\",style:{padding:2}},/*#__PURE__*/React.createElement(\"h4\",null,\"Start Date\"),/*#__PURE__*/React.createElement(DatePicker,{defaultTimestamp:state.ban.banStart,onChange:function onChange(val){return setBan('banStart',val);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\",style:{padding:2}},/*#__PURE__*/React.createElement(\"h4\",null,\"End Date\"),/*#__PURE__*/React.createElement(DatePicker,{defaultTimestamp:state.ban.banEnd,onChange:function onChange(val){return setBan('banEnd',val);}})),/*#__PURE__*/React.createElement(Row,{className:\"mt-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"\\xA0 \"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 text-right\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success\",disabled:state.showSpinner},state.showSpinner?/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-spinner fa-spin\"}):'Save')))))));}","map":{"version":3,"sources":["/Users/cpettyjohn/Habbo/instinct/packages/frontend/admin/src/users/bans/ban-editor/BanEditor.tsx"],"names":["Modal","ModalBody","ModalHeader","React","useContext","useEffect","useState","Avatar","Form","Row","sessionContext","userService","DatePicker","defaultBanDTO","defaultBanEditorState","BanEditor","children","defaultBan","onSave","session","username","setUsername","ban","userID","user","id","state","setState","mergeUser","getByID","fetchUser","setValue","getByUsername","setBan","key","value","_","toggleModal","showModal","onSubmit","showError","showSpinner","padding","e","target","figure","reason","banStart","val","banEnd"],"mappings":"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","sourcesContent":["import {UserBanDTO} from '@instinct-prj/interface';\nimport {Modal, ModalBody, ModalHeader} from 'reactstrap';\nimport React, {useContext, useEffect, useState} from 'react';\nimport {\n  Avatar,\n  Form,\n  Row,\n  sessionContext,\n  userService,\n  DatePicker,\n} from '@instinct-prj/frontend';\nimport {\n  BanEditorProps,\n  BanEditorState,\n  defaultBanDTO,\n  defaultBanEditorState,\n} from './BanEditor.types';\n\nexport function BanEditor({\n  children,\n  defaultBan = defaultBanDTO,\n  onSave,\n}: BanEditorProps) {\n  const session = useContext(sessionContext);\n  const [username, setUsername] = useState('');\n  const [state, setState] = useState<BanEditorState>({\n    ...defaultBanEditorState,\n    ban: {\n      ...defaultBan,\n      userID: session.user!.id,\n    },\n  });\n\n  useEffect(() => {\n    async function mergeUser(userID: number) {\n      const user = await userService.getByID(userID);\n      setUsername(user.username);\n    }\n\n    mergeUser(state.ban.userID);\n  }, [state.ban.userID]);\n\n  useEffect(() => {\n    async function fetchUser(userID: number) {\n      const user = await userService.getByID(userID);\n      setValue('user', user);\n    }\n\n    fetchUser(state.ban.userID);\n  }, [state.ban.userID]);\n\n  useEffect(() => {\n    async function fetchUser(username: string) {\n      const user = await userService.getByUsername(username);\n      setBan('userID', user.user.id);\n    }\n\n    fetchUser(username);\n  }, [username]);\n\n  function setValue<K extends keyof BanEditorState>(\n    key: K,\n    value: BanEditorState[K]\n  ): void {\n    setState(_ => ({\n      ..._,\n      [key]: value,\n    }));\n  }\n\n  function setBan<K extends keyof UserBanDTO>(\n    key: K,\n    value: UserBanDTO[K]\n  ): void {\n    setState(_ => ({\n      ..._,\n      ban: {\n        ..._.ban,\n        [key]: value,\n      },\n    }));\n  }\n\n  function toggleModal(): void {\n    setState(_ => ({\n      ..._,\n      showModal: !_.showModal,\n    }));\n  }\n\n  async function onSubmit() {\n    setValue('showSpinner', true);\n\n    try {\n      await onSave(state.ban);\n      setValue('showSpinner', false);\n    } catch {\n      setState(_ => ({\n        ..._,\n        showError: true,\n        showSpinner: false,\n      }));\n    }\n  }\n\n  return (\n    <>\n      <div onClick={toggleModal}>{children}</div>\n      <Modal isOpen={state.showModal} toggle={toggleModal}>\n        <ModalHeader toggle={toggleModal}>Ban Editor</ModalHeader>\n        <ModalBody>\n          <Form className=\"\" onSubmit={onSubmit}>\n            <div className=\"row mt-3\" style={{padding: 2}}>\n              <div className=\"col-8\">\n                <h4>Username</h4>\n                <input\n                  className=\"form-control\"\n                  type=\"text\"\n                  value={username}\n                  onChange={e => setUsername(e.target.value)}\n                />\n              </div>\n              <div className=\"col-4\">\n                <Avatar className=\"mt-2\" look={state.user?.figure} headOnly />\n              </div>\n            </div>\n\n            <div className=\"mt-3\" style={{padding: 2}}>\n              <h4>Reason</h4>\n              <textarea\n                className=\"form-control\"\n                rows={3}\n                value={state.ban.reason}\n                onChange={e => setBan('reason', e.target.value)}\n              />\n            </div>\n\n            <div className=\"mt-3\" style={{padding: 2}}>\n              <h4>Start Date</h4>\n              <DatePicker\n                defaultTimestamp={state.ban.banStart}\n                onChange={val => setBan('banStart', val)}\n              />\n            </div>\n\n            <div className=\"mt-3\" style={{padding: 2}}>\n              <h4>End Date</h4>\n              <DatePicker\n                defaultTimestamp={state.ban.banEnd}\n                onChange={val => setBan('banEnd', val)}\n              />\n            </div>\n\n            <Row className=\"mt-3\">\n              <div className=\"col-6\">&nbsp; </div>\n              <div className=\"col-6 text-right\">\n                <button\n                  className=\"btn btn-success\"\n                  disabled={state.showSpinner}\n                >\n                  {state.showSpinner ? (\n                    <i className=\"fa fa-spinner fa-spin\" />\n                  ) : (\n                    'Save'\n                  )}\n                </button>\n              </div>\n            </Row>\n          </Form>\n        </ModalBody>\n      </Modal>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}