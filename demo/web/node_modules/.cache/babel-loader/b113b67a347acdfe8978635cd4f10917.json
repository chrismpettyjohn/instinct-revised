{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cpettyjohn/Habbo/instinct-revised/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{omit}from'lodash';import{toast}from'react-toastify';import React,{useState}from'react';import{FormGroup,Modal,ModalBody,ModalFooter,ModalHeader}from'reactstrap';import{Avatar,Form,Icon,Input,manageUsersService,useFetchAllRanks,Select}from'@instinct-prj/frontend';export function EditUserModal(_ref){var _ranks$find;var user=_ref.user,onUpdated=_ref.onUpdated;var ranks=useFetchAllRanks();var _useState=useState(_objectSpread(_objectSpread({},omit(user,'joinDate','lastLoginDate')),{},{password:'',userOfTheWeek:user.userOfTheWeek?1:0})),_useState2=_slicedToArray(_useState,2),updatedUser=_useState2[0],setUpdatedUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),confirmDelete=_useState4[0],setConfirmDelete=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showModal=_useState6[0],setModal=_useState6[1];function _onChange(key,value){setUpdatedUser(function(_){return _objectSpread(_objectSpread({},_),{},_defineProperty({},key,value));});}function onToggle(){setModal(function(_){return!_;});setConfirmDelete(false);}function onToggleDelete(){return _onToggleDelete.apply(this,arguments);}function _onToggleDelete(){_onToggleDelete=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(confirmDelete){_context.next=3;break;}setConfirmDelete(function(_){return!_;});return _context.abrupt(\"return\");case 3:_context.next=5;return manageUsersService.delete(user.id);case 5:toast.info(\"\".concat(user.username,\"'s account has been deleted\"));onUpdated();case 7:case\"end\":return _context.stop();}}},_callee);}));return _onToggleDelete.apply(this,arguments);}function onSubmit(){return _onSubmit.apply(this,arguments);}function _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return manageUsersService.update(user.id,updatedUser);case 2:toast.info(\"\".concat(updatedUser.username,\"'s account has been updated\"));setModal(false);onUpdated();case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _onSubmit.apply(this,arguments);}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"admin-article row mb-3\",style:{height:100,width:'100%'}},/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(Avatar,{look:updatedUser.figure,headOnly:true})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-8 text-right\"},/*#__PURE__*/React.createElement(\"h3\",null,updatedUser.username),/*#__PURE__*/React.createElement(\"div\",{className:\"row mr-2\",style:{float:'right'}},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-info\",onClick:onToggle},/*#__PURE__*/React.createElement(Icon,{type:\"pencil\"}),\"Edit\")))),/*#__PURE__*/React.createElement(Modal,{isOpen:showModal,toggle:onToggle},/*#__PURE__*/React.createElement(ModalHeader,{toggle:onToggle},\"Edit User\"),/*#__PURE__*/React.createElement(Form,{className:\"\",onSubmit:onSubmit},/*#__PURE__*/React.createElement(ModalBody,null,/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"label\",null,\"Username\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"username\",value:updatedUser.username,onChange:_onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"label\",null,\"Email\"),/*#__PURE__*/React.createElement(Input,{type:\"email\",name:\"email\",value:updatedUser.email,onChange:_onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"label\",null,\"Password\"),/*#__PURE__*/React.createElement(Input,{type:\"password\",name:\"password\",value:updatedUser.password,onChange:_onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"label\",null,\"Rank\"),!ranks&&/*#__PURE__*/React.createElement(Icon,{className:\"fa-spin\",type:\"spinner\"}),ranks&&/*#__PURE__*/React.createElement(Select,{options:ranks,value:(_ranks$find=ranks.find(function(_){return _.id===updatedUser.rankID;}))!==null&&_ranks$find!==void 0?_ranks$find:null,getOptionLabel:function getOptionLabel(_){return _.name;},getOptionValue:function getOptionValue(_){return _.id;},onChange:function onChange(_){return _onChange('rankID',_.id);}})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"label\",null,\"Figure\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"figure\",value:updatedUser.figure,onChange:_onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"label\",null,\"Credits\"),/*#__PURE__*/React.createElement(Input,{type:\"number\",name:\"credits\",value:updatedUser.credits,onChange:_onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"label\",null,\"Pixels\"),/*#__PURE__*/React.createElement(Input,{type:\"number\",name:\"pixels\",value:updatedUser.pixels,onChange:_onChange})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"label\",null,\"Points\"),/*#__PURE__*/React.createElement(Input,{type:\"number\",name:\"points\",value:updatedUser.points,onChange:_onChange}))),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row w-100\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-danger\",onClick:onToggleDelete,type:\"button\"},confirmDelete?/*#__PURE__*/React.createElement(React.Fragment,null,\"Are you sure?\"):/*#__PURE__*/React.createElement(React.Fragment,null,\"Delete Account\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 text-right\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success\",type:\"submit\"},\"Save\")))))));}","map":{"version":3,"sources":["/Users/cpettyjohn/Habbo/instinct-revised/packages/frontend/admin/src/users/users/edit-user-modal/EditUserModal.tsx"],"names":["omit","toast","React","useState","FormGroup","Modal","ModalBody","ModalFooter","ModalHeader","Avatar","Form","Icon","Input","manageUsersService","useFetchAllRanks","Select","EditUserModal","user","onUpdated","ranks","password","userOfTheWeek","updatedUser","setUpdatedUser","confirmDelete","setConfirmDelete","showModal","setModal","onChange","key","value","_","onToggle","onToggleDelete","delete","id","info","username","onSubmit","update","height","width","figure","float","email","find","rankID","name","credits","pixels","points"],"mappings":"yxBAAA,OAAQA,IAAR,KAAmB,QAAnB,CACA,OAAQC,KAAR,KAAoB,gBAApB,CACA,MAAOC,CAAAA,KAAP,EAAeC,QAAf,KAA8B,OAA9B,CAGA,OACEC,SADF,CAEEC,KAFF,CAGEC,SAHF,CAIEC,WAJF,CAKEC,WALF,KAMO,YANP,CAOA,OACEC,MADF,CAEEC,IAFF,CAGEC,IAHF,CAIEC,KAJF,CAKEC,kBALF,CAMEC,gBANF,CAOEC,MAPF,KAQO,wBARP,CAUA,MAAO,SAASC,CAAAA,aAAT,MAA8D,oBAAtCC,CAAAA,IAAsC,MAAtCA,IAAsC,CAAhCC,SAAgC,MAAhCA,SAAgC,CACnE,GAAMC,CAAAA,KAAK,CAAGL,gBAAgB,EAA9B,CADmE,cAE7BX,QAAQ,gCACzCH,IAAI,CAACiB,IAAD,CAAO,UAAP,CAAmB,eAAnB,CADqC,MAE5CG,QAAQ,CAAE,EAFkC,CAG5CC,aAAa,CAAEJ,IAAI,CAACI,aAAL,CAAqB,CAArB,CAAyB,CAHI,GAFqB,wCAE5DC,WAF4D,eAE/CC,cAF+C,8BAOzBpB,QAAQ,CAAC,KAAD,CAPiB,yCAO5DqB,aAP4D,eAO7CC,gBAP6C,8BAQrCtB,QAAQ,CAAC,KAAD,CAR6B,yCAQ5DuB,SAR4D,eAQjDC,QARiD,eAUnE,QAASC,CAAAA,SAAT,CACEC,GADF,CAEEC,KAFF,CAGE,CACAP,cAAc,CAAC,SAAAQ,CAAC,wCACXA,CADW,wBAEbF,GAFa,CAEPC,KAFO,IAAF,CAAd,CAID,CAED,QAASE,CAAAA,QAAT,EAAoB,CAClBL,QAAQ,CAAC,SAAAI,CAAC,QAAI,CAACA,CAAL,EAAF,CAAR,CACAN,gBAAgB,CAAC,KAAD,CAAhB,CACD,CAvBkE,QAyBpDQ,CAAAA,cAzBoD,oJAyBnE,sIACOT,aADP,yBAEIC,gBAAgB,CAAC,SAAAM,CAAC,QAAI,CAACA,CAAL,EAAF,CAAhB,CAFJ,8DAMQlB,CAAAA,kBAAkB,CAACqB,MAAnB,CAA0BjB,IAAI,CAACkB,EAA/B,CANR,QAOElC,KAAK,CAACmC,IAAN,WAAcnB,IAAI,CAACoB,QAAnB,iCACAnB,SAAS,GARX,sDAzBmE,yDAoCpDoB,CAAAA,QApCoD,kIAoCnE,+JACQzB,CAAAA,kBAAkB,CAAC0B,MAAnB,CAA0BtB,IAAI,CAACkB,EAA/B,CAAmCb,WAAnC,CADR,QAEErB,KAAK,CAACmC,IAAN,WAAcd,WAAW,CAACe,QAA1B,iCACAV,QAAQ,CAAC,KAAD,CAAR,CACAT,SAAS,GAJX,wDApCmE,2CA2CnE,mBACE,qDACE,2BACE,SAAS,CAAC,wBADZ,CAEE,KAAK,CAAE,CAACsB,MAAM,CAAE,GAAT,CAAcC,KAAK,CAAE,MAArB,CAFT,eAIE,2BAAK,SAAS,CAAC,OAAf,eACE,oBAAC,MAAD,EAAQ,IAAI,CAAEnB,WAAW,CAACoB,MAA1B,CAAkC,QAAQ,KAA1C,EADF,CAJF,cAOE,2BAAK,SAAS,CAAC,kBAAf,eACE,8BAAKpB,WAAW,CAACe,QAAjB,CADF,cAEE,2BAAK,SAAS,CAAC,UAAf,CAA0B,KAAK,CAAE,CAACM,KAAK,CAAE,OAAR,CAAjC,eACE,8BAAQ,SAAS,CAAC,cAAlB,CAAiC,OAAO,CAAEX,QAA1C,eACE,oBAAC,IAAD,EAAM,IAAI,CAAC,QAAX,EADF,QADF,CAFF,CAPF,CADF,cAkBE,oBAAC,KAAD,EAAO,MAAM,CAAEN,SAAf,CAA0B,MAAM,CAAEM,QAAlC,eACE,oBAAC,WAAD,EAAa,MAAM,CAAEA,QAArB,cADF,cAEE,oBAAC,IAAD,EAAM,SAAS,CAAC,EAAhB,CAAmB,QAAQ,CAAEM,QAA7B,eACE,oBAAC,SAAD,mBACE,oBAAC,SAAD,mBACE,4CADF,cAEE,oBAAC,KAAD,EACE,IAAI,CAAC,MADP,CAEE,IAAI,CAAC,UAFP,CAGE,KAAK,CAAEhB,WAAW,CAACe,QAHrB,CAIE,QAAQ,CAAET,SAJZ,EAFF,CADF,cAUE,oBAAC,SAAD,mBACE,yCADF,cAEE,oBAAC,KAAD,EACE,IAAI,CAAC,OADP,CAEE,IAAI,CAAC,OAFP,CAGE,KAAK,CAAEN,WAAW,CAACsB,KAHrB,CAIE,QAAQ,CAAEhB,SAJZ,EAFF,CAVF,cAmBE,oBAAC,SAAD,mBACE,4CADF,cAEE,oBAAC,KAAD,EACE,IAAI,CAAC,UADP,CAEE,IAAI,CAAC,UAFP,CAGE,KAAK,CAAEN,WAAW,CAACF,QAHrB,CAIE,QAAQ,CAAEQ,SAJZ,EAFF,CAnBF,cA4BE,oBAAC,SAAD,mBACE,wCADF,CAEG,CAACT,KAAD,eAAU,oBAAC,IAAD,EAAM,SAAS,CAAC,SAAhB,CAA0B,IAAI,CAAC,SAA/B,EAFb,CAGGA,KAAK,eACJ,oBAAC,MAAD,EACE,OAAO,CAAEA,KADX,CAEE,KAAK,cAAEA,KAAK,CAAC0B,IAAN,CAAW,SAAAd,CAAC,QAAIA,CAAAA,CAAC,CAACI,EAAF,GAASb,WAAW,CAACwB,MAAzB,EAAZ,CAAF,2CAAkD,IAFzD,CAGE,cAAc,CAAE,wBAACf,CAAD,QAAYA,CAAAA,CAAC,CAACgB,IAAd,EAHlB,CAIE,cAAc,CAAE,wBAAChB,CAAD,QAAYA,CAAAA,CAAC,CAACI,EAAd,EAJlB,CAKE,QAAQ,CAAE,kBAACJ,CAAD,QAAYH,CAAAA,SAAQ,CAAC,QAAD,CAAWG,CAAC,CAACI,EAAb,CAApB,EALZ,EAJJ,CA5BF,cAyCE,oBAAC,SAAD,mBACE,0CADF,cAEE,oBAAC,KAAD,EACE,IAAI,CAAC,MADP,CAEE,IAAI,CAAC,QAFP,CAGE,KAAK,CAAEb,WAAW,CAACoB,MAHrB,CAIE,QAAQ,CAAEd,SAJZ,EAFF,CAzCF,cAkDE,oBAAC,SAAD,mBACE,2CADF,cAEE,oBAAC,KAAD,EACE,IAAI,CAAC,QADP,CAEE,IAAI,CAAC,SAFP,CAGE,KAAK,CAAEN,WAAW,CAAC0B,OAHrB,CAIE,QAAQ,CAAEpB,SAJZ,EAFF,CAlDF,cA2DE,oBAAC,SAAD,mBACE,0CADF,cAEE,oBAAC,KAAD,EACE,IAAI,CAAC,QADP,CAEE,IAAI,CAAC,QAFP,CAGE,KAAK,CAAEN,WAAW,CAAC2B,MAHrB,CAIE,QAAQ,CAAErB,SAJZ,EAFF,CA3DF,cAoEE,oBAAC,SAAD,mBACE,0CADF,cAEE,oBAAC,KAAD,EACE,IAAI,CAAC,QADP,CAEE,IAAI,CAAC,QAFP,CAGE,KAAK,CAAEN,WAAW,CAAC4B,MAHrB,CAIE,QAAQ,CAAEtB,SAJZ,EAFF,CApEF,CADF,cA+EE,oBAAC,WAAD,mBACE,2BAAK,SAAS,CAAC,WAAf,eACE,2BAAK,SAAS,CAAC,OAAf,eACE,8BACE,SAAS,CAAC,gBADZ,CAEE,OAAO,CAAEK,cAFX,CAGE,IAAI,CAAC,QAHP,EAKGT,aAAa,cAAG,wDAAH,cAAwB,yDALxC,CADF,CADF,cAUE,2BAAK,SAAS,CAAC,kBAAf,eACE,8BAAQ,SAAS,CAAC,iBAAlB,CAAoC,IAAI,CAAC,QAAzC,SADF,CAVF,CADF,CA/EF,CAFF,CAlBF,CADF,CA0HD","sourcesContent":["import {omit} from 'lodash';\nimport {toast} from 'react-toastify';\nimport React, {useState} from 'react';\nimport {EditUserModalProps} from './EditUserModal.types';\nimport {InternalUser, InternalUserDTO} from '@instinct-prj/interface';\nimport {\n  FormGroup,\n  Modal,\n  ModalBody,\n  ModalFooter,\n  ModalHeader,\n} from 'reactstrap';\nimport {\n  Avatar,\n  Form,\n  Icon,\n  Input,\n  manageUsersService,\n  useFetchAllRanks,\n  Select,\n} from '@instinct-prj/frontend';\n\nexport function EditUserModal({user, onUpdated}: EditUserModalProps) {\n  const ranks = useFetchAllRanks();\n  const [updatedUser, setUpdatedUser] = useState<InternalUserDTO>({\n    ...omit(user, 'joinDate', 'lastLoginDate'),\n    password: '',\n    userOfTheWeek: user.userOfTheWeek ? 1 : 0,\n  });\n  const [confirmDelete, setConfirmDelete] = useState(false);\n  const [showModal, setModal] = useState(false);\n\n  function onChange<K extends keyof InternalUser>(\n    key: K,\n    value: InternalUser[K]\n  ) {\n    setUpdatedUser(_ => ({\n      ..._,\n      [key]: value,\n    }));\n  }\n\n  function onToggle() {\n    setModal(_ => !_);\n    setConfirmDelete(false);\n  }\n\n  async function onToggleDelete() {\n    if (!confirmDelete) {\n      setConfirmDelete(_ => !_);\n      return;\n    }\n\n    await manageUsersService.delete(user.id);\n    toast.info(`${user.username}'s account has been deleted`);\n    onUpdated();\n  }\n\n  async function onSubmit() {\n    await manageUsersService.update(user.id, updatedUser);\n    toast.info(`${updatedUser.username}'s account has been updated`);\n    setModal(false);\n    onUpdated();\n  }\n\n  return (\n    <>\n      <div\n        className=\"admin-article row mb-3\"\n        style={{height: 100, width: '100%'}}\n      >\n        <div className=\"col-4\">\n          <Avatar look={updatedUser.figure} headOnly />\n        </div>\n        <div className=\"col-8 text-right\">\n          <h3>{updatedUser.username}</h3>\n          <div className=\"row mr-2\" style={{float: 'right'}}>\n            <button className=\"btn btn-info\" onClick={onToggle}>\n              <Icon type=\"pencil\" />\n              Edit\n            </button>\n          </div>\n        </div>\n      </div>\n      <Modal isOpen={showModal} toggle={onToggle}>\n        <ModalHeader toggle={onToggle}>Edit User</ModalHeader>\n        <Form className=\"\" onSubmit={onSubmit}>\n          <ModalBody>\n            <FormGroup>\n              <label>Username</label>\n              <Input\n                type=\"text\"\n                name=\"username\"\n                value={updatedUser.username}\n                onChange={onChange}\n              />\n            </FormGroup>\n            <FormGroup>\n              <label>Email</label>\n              <Input\n                type=\"email\"\n                name=\"email\"\n                value={updatedUser.email}\n                onChange={onChange}\n              />\n            </FormGroup>\n            <FormGroup>\n              <label>Password</label>\n              <Input\n                type=\"password\"\n                name=\"password\"\n                value={updatedUser.password}\n                onChange={onChange}\n              />\n            </FormGroup>\n            <FormGroup>\n              <label>Rank</label>\n              {!ranks && <Icon className=\"fa-spin\" type=\"spinner\" />}\n              {ranks && (\n                <Select\n                  options={ranks}\n                  value={ranks.find(_ => _.id === updatedUser.rankID) ?? null}\n                  getOptionLabel={(_: any) => _.name}\n                  getOptionValue={(_: any) => _.id}\n                  onChange={(_: any) => onChange('rankID', _.id)}\n                />\n              )}\n            </FormGroup>\n            <FormGroup>\n              <label>Figure</label>\n              <Input\n                type=\"text\"\n                name=\"figure\"\n                value={updatedUser.figure}\n                onChange={onChange}\n              />\n            </FormGroup>\n            <FormGroup>\n              <label>Credits</label>\n              <Input\n                type=\"number\"\n                name=\"credits\"\n                value={updatedUser.credits}\n                onChange={onChange}\n              />\n            </FormGroup>\n            <FormGroup>\n              <label>Pixels</label>\n              <Input\n                type=\"number\"\n                name=\"pixels\"\n                value={updatedUser.pixels}\n                onChange={onChange}\n              />\n            </FormGroup>\n            <FormGroup>\n              <label>Points</label>\n              <Input\n                type=\"number\"\n                name=\"points\"\n                value={updatedUser.points}\n                onChange={onChange}\n              />\n            </FormGroup>\n          </ModalBody>\n          <ModalFooter>\n            <div className=\"row w-100\">\n              <div className=\"col-6\">\n                <button\n                  className=\"btn btn-danger\"\n                  onClick={onToggleDelete}\n                  type=\"button\"\n                >\n                  {confirmDelete ? <>Are you sure?</> : <>Delete Account</>}\n                </button>\n              </div>\n              <div className=\"col-6 text-right\">\n                <button className=\"btn btn-success\" type=\"submit\">\n                  Save\n                </button>\n              </div>\n            </div>\n          </ModalFooter>\n        </Form>\n      </Modal>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}