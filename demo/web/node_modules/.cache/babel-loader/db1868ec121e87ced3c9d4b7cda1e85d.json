{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cpettyjohn/Habbo/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Link}from'wouter';import{toast}from'react-toastify';import React,{useState}from'react';import MDEditor from'@uiw/react-md-editor';import{AdminLayout,Card,Container,Form,Icon,Input,Jumbotron,Row,Select,PreviewImage,useFetchAllNewsCategories,Skeleton}from'@instinct-prj/frontend';import{defaultNewsArticleEditorState}from'./NewsArticleEdtitor.types';export function NewsArticleEditor(_ref){var _categories$find;var defaultArticle=_ref.defaultArticle,onSave=_ref.onSave;var categories=useFetchAllNewsCategories();var _useState=useState(_objectSpread(_objectSpread({},defaultNewsArticleEditorState),{},{article:defaultArticle!==null&&defaultArticle!==void 0?defaultArticle:defaultNewsArticleEditorState.article})),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];function setValue(key,value){setState(function(_){return _objectSpread(_objectSpread({},_),{},_defineProperty({},key,value));});}function setArticleValue(key,value){editArticle(_defineProperty({},key,value));}function editArticle(article){setState(function(_){return _objectSpread(_objectSpread({},_),{},{article:_objectSpread(_objectSpread({},_.article),article)});});}function onSubmit(){return _onSubmit.apply(this,arguments);}function _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setValue('showSpinner',true);_context.prev=1;_context.next=4;return onSave({title:state.article.title,content:state.article.content,description:state.article.description,categoryID:state.article.category.id,headerImage:state.article.headerImage,thumbnailImage:state.article.thumbnailImage});case 4:toast.success('Your changes have been saved');setValue('showSpinner',false);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);setState(function(_){return _objectSpread(_objectSpread({},_),{},{showError:true,showSpinner:false});});case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return _onSubmit.apply(this,arguments);}return/*#__PURE__*/React.createElement(AdminLayout,{permission:\"websiteManageNews\"},/*#__PURE__*/React.createElement(Jumbotron,{style:{background:'#263238',backgroundImage:\"url(\".concat(state.article.headerImage,\")\"),backgroundSize:'100%'},title:state.article.title},/*#__PURE__*/React.createElement(\"p\",null,state.article.description)),/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Link,{to:\"/admin/news/articles\"},/*#__PURE__*/React.createElement(Icon,{className:\"text-white fa-2x\",type:\"arrow-left\"})),/*#__PURE__*/React.createElement(Card,{header:\"Editor\"},/*#__PURE__*/React.createElement(Form,{className:\"\",onSubmit:onSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\",style:{padding:2}},/*#__PURE__*/React.createElement(\"h4\",null,\"Title\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"title\",onChange:setArticleValue,value:state.article.title})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\",style:{padding:2}},/*#__PURE__*/React.createElement(\"h4\",null,\"Description\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"description\",onChange:setArticleValue,value:state.article.description})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\",style:{padding:2}},/*#__PURE__*/React.createElement(\"h4\",null,\"Category\"),/*#__PURE__*/React.createElement(Skeleton,{isLoading:categories===undefined},/*#__PURE__*/React.createElement(Select,{options:categories,value:(_categories$find=categories===null||categories===void 0?void 0:categories.find(function(_){return _.id===state.article.category.id;}))!==null&&_categories$find!==void 0?_categories$find:null,getOptionLabel:function getOptionLabel(x){return x.name;},getOptionValue:function getOptionValue(x){return\"\".concat(x.id);},onChange:function onChange(_){return setArticleValue('category',_);}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\",style:{padding:2}},/*#__PURE__*/React.createElement(\"h4\",null,\"Header\",/*#__PURE__*/React.createElement(\"small\",null,/*#__PURE__*/React.createElement(PreviewImage,{className:\"ml-2\",image:state.article.headerImage}))),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"headerImage\",onChange:setArticleValue,value:state.article.headerImage})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\",style:{padding:2}},/*#__PURE__*/React.createElement(\"h4\",null,\"Thumbnail\",/*#__PURE__*/React.createElement(\"small\",null,/*#__PURE__*/React.createElement(PreviewImage,{className:\"ml-2\",image:state.article.thumbnailImage}))),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"thumbnailImage\",onChange:setArticleValue,value:state.article.thumbnailImage})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Content\"),/*#__PURE__*/React.createElement(MDEditor,{value:state.article.content,onChange:function onChange(content){return editArticle({content:content});}})),/*#__PURE__*/React.createElement(Row,{className:\"mt-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"\\xA0\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 text-right\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary\",disabled:state.showSpinner},state.showSpinner?/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-spinner fa-spin\"}):'Save')))))));}","map":{"version":3,"sources":["/Users/cpettyjohn/Habbo/instinct/packages/frontend/admin/src/news-articles/articles/editor/NewsArticleEditor.tsx"],"names":["Link","toast","React","useState","MDEditor","AdminLayout","Card","Container","Form","Icon","Input","Jumbotron","Row","Select","PreviewImage","useFetchAllNewsCategories","Skeleton","defaultNewsArticleEditorState","NewsArticleEditor","defaultArticle","onSave","categories","article","state","setState","setValue","key","value","_","setArticleValue","editArticle","onSubmit","title","content","description","categoryID","category","id","headerImage","thumbnailImage","success","showError","showSpinner","background","backgroundImage","backgroundSize","padding","undefined","find","x","name"],"mappings":"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","sourcesContent":["import {Link} from 'wouter';\nimport {toast} from 'react-toastify';\nimport React, {useState} from 'react';\nimport MDEditor from '@uiw/react-md-editor';\nimport {Article} from '@instinct-prj/interface';\nimport {\n  AdminLayout,\n  Card,\n  Container,\n  Form,\n  Icon,\n  Input,\n  Jumbotron,\n  Row,\n  Select,\n  PreviewImage,\n  useFetchAllNewsCategories,\n  Skeleton,\n} from '@instinct-prj/frontend';\nimport {\n  defaultNewsArticleEditorState,\n  NewsArticleEditorProps,\n  NewsArticleEditorState,\n} from './NewsArticleEdtitor.types';\n\nexport function NewsArticleEditor({\n  defaultArticle,\n  onSave,\n}: NewsArticleEditorProps) {\n  const categories = useFetchAllNewsCategories();\n  const [state, setState] = useState<NewsArticleEditorState>({\n    ...defaultNewsArticleEditorState,\n    article: defaultArticle ?? defaultNewsArticleEditorState.article,\n  });\n\n  function setValue<K extends keyof NewsArticleEditorState>(\n    key: K,\n    value: NewsArticleEditorState[K]\n  ): void {\n    setState(_ => ({\n      ..._,\n      [key]: value,\n    }));\n  }\n\n  function setArticleValue<K extends keyof Article>(\n    key: K,\n    value: Article[K]\n  ): void {\n    editArticle({\n      [key]: value,\n    });\n  }\n\n  function editArticle(article: Partial<Article>): void {\n    setState(_ => ({\n      ..._,\n      article: {\n        ..._.article,\n        ...article,\n      },\n    }));\n  }\n\n  async function onSubmit() {\n    setValue('showSpinner', true);\n\n    try {\n      await onSave({\n        title: state.article.title,\n        content: state.article.content,\n        description: state.article.description,\n        categoryID: state.article.category.id,\n        headerImage: state.article.headerImage,\n        thumbnailImage: state.article.thumbnailImage,\n      });\n      toast.success('Your changes have been saved');\n      setValue('showSpinner', false);\n    } catch {\n      setState(_ => ({\n        ..._,\n        showError: true,\n        showSpinner: false,\n      }));\n    }\n  }\n\n  return (\n    <AdminLayout permission=\"websiteManageNews\">\n      <Jumbotron\n        style={{\n          background: '#263238',\n          backgroundImage: `url(${state.article.headerImage})`,\n          backgroundSize: '100%',\n        }}\n        title={state.article.title}\n      >\n        <p>{state.article.description}</p>\n      </Jumbotron>\n      <Container>\n        <Link to=\"/admin/news/articles\">\n          <Icon className=\"text-white fa-2x\" type=\"arrow-left\" />\n        </Link>\n        <Card header=\"Editor\">\n          <Form className=\"\" onSubmit={onSubmit}>\n            <div className=\"mt-3\" style={{padding: 2}}>\n              <h4>Title</h4>\n              <Input\n                type=\"text\"\n                name=\"title\"\n                onChange={setArticleValue}\n                value={state.article.title}\n              />\n            </div>\n            <div className=\"mt-3\" style={{padding: 2}}>\n              <h4>Description</h4>\n              <Input\n                type=\"text\"\n                name=\"description\"\n                onChange={setArticleValue}\n                value={state.article.description}\n              />\n            </div>\n            <div className=\"mt-3\" style={{padding: 2}}>\n              <h4>Category</h4>\n              <Skeleton isLoading={categories === undefined}>\n                <Select\n                  options={categories}\n                  value={\n                    categories?.find(_ => _.id === state.article.category.id) ??\n                    null\n                  }\n                  getOptionLabel={(x: any) => x.name}\n                  getOptionValue={(x: any) => `${x.id}`}\n                  onChange={(_: any) => setArticleValue('category', _)}\n                />\n              </Skeleton>\n            </div>\n            <div className=\"mt-3\" style={{padding: 2}}>\n              <h4>\n                Header\n                <small>\n                  <PreviewImage\n                    className=\"ml-2\"\n                    image={state.article.headerImage}\n                  />\n                </small>\n              </h4>\n              <Input\n                type=\"text\"\n                name=\"headerImage\"\n                onChange={setArticleValue}\n                value={state.article.headerImage}\n              />\n            </div>\n            <div className=\"mt-3\" style={{padding: 2}}>\n              <h4>\n                Thumbnail\n                <small>\n                  <PreviewImage\n                    className=\"ml-2\"\n                    image={state.article.thumbnailImage}\n                  />\n                </small>\n              </h4>\n              <Input\n                type=\"text\"\n                name=\"thumbnailImage\"\n                onChange={setArticleValue}\n                value={state.article.thumbnailImage}\n              />\n            </div>\n            <div className=\"mt-3\">\n              <h4>Content</h4>\n              <MDEditor\n                value={state.article.content}\n                onChange={(content: any) => editArticle({content})}\n              />\n            </div>\n            <Row className=\"mt-3\">\n              <div className=\"col-6\">&nbsp;</div>\n              <div className=\"col-6 text-right\">\n                <button\n                  className=\"btn btn-primary\"\n                  disabled={state.showSpinner}\n                >\n                  {state.showSpinner ? (\n                    <i className=\"fa fa-spinner fa-spin\" />\n                  ) : (\n                    'Save'\n                  )}\n                </button>\n              </div>\n            </Row>\n          </Form>\n        </Card>\n      </Container>\n    </AdminLayout>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}